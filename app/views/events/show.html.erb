<% provide(:title, @event.title) %>
<header>
  <h1 id="show-title"><%= @event.title %></h1>

  <ul class="actions">
    <li><%= link_to "Edit Event", edit_event_path(@event), class: "edit" if policy(@event).edit? %> | <%= link_to "Delete Event", event_path(@event), method: :delete, data: {confirm: "Are you sure?"}, class: "delete" if policy(@event).destroy? %> |<% if @event.seats_left > 0 %> <%= link_to "Register", event_attendances_path(@event), method: :post, class: "new"  %> <% else %> <span class="badge rounded-pill bg-danger pull-right">No seats left</span> <% end %></li>
  </ul>
</header>


<div class="row">
  <div class="col-sm-3 offset-md-10">
    <div class="sidebar">
      <h3 class="discover">Organizer</h3>
      <ul class="nav nav-pills nav-stacked">
        <%= link_to @event.organizer.username, user_path(@event.organizer) %>
      </ul>
      <h3 class="attendees">Attending</h3>
      <ul class="nav nav-pills nav-stacked">
        <%= @event.attendees.count %>
      </ul>
      <span class="badge rounded-pill <%= (@event.seats_left > 0) ? "bg-primary" : "bg-danger"%>"><%= pluralize(@event.seats_left, "Seat") %> available</span>
    </div>
  </div>
</div>

<div>
  <%= image_tag @event.image.url, class: "event-image", height: 300, width: 800 if @event.image %>
  <p><%= @event.description%></p>
  <p><%= @event.start_date.strftime("%e %b %Y %H:%M:%S%p") %></p>
  <p><%= @event.end_date.strftime("%e %b %Y %H:%M:%S%p") %></p>
  <p><%= @event.venue %></p>
  <p><%= @event.location %></p>
</div>

<p><%= link_to "Edit Event", edit_event_path(@event) %> | <%= link_to "Delete This Event", event_path(@event), method: :delete, data: {confirm: "Are you sure?"} %> </p>


<header>
  <h3>Comments</h3>
</header>

<div id="comments">
  <% if @event.comments.any? %>
    <%= render @event.comments %>
  <% else %>
    <p>No comments yet...</p>
  <% end %>
</div>


<%= render "comments/form", event: @event, comment: @comment if policy(@comment).create? %>
